<!DOCTYPE html>
<html lang=en>
  <head>
    <title>Twittler!</title>
    <link href='http://fonts.googleapis.com/css?family=Special+Elite' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Spicy+Rice' rel='stylesheet' type='text/css'>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap-responsive.css">
    <link rel="stylesheet" type="text/css" href="stylesheet.css">
    <meta charset="utf-8"/> 
  </head>
  <body>
    <script>

      $(document).ready(function(){

        var $body = $('body');
        
        $body.html('');

        
        $body.append('<h1 id="twittlerTitle">twittler</h1>\n<div class="stuffContainer" id="buttonsAndInput"></div>\n<div class="stuffContainer" id="bodyOfTweets"></div>\n<div class="stuffContainer" id="timeline"></div>');

        $('div#buttonsAndInput').append('<input id="writeOwnTweet" type="text" placeholder=" chirp chirp">\n<input class="btn" id="submit-btn" type="submit" value="post"></br>\n<button class="btn btn-danger" id="newTweeter">random tweet</button>');


        var index = streams.home.length - 1;
        while(index >= 0){
          
          var d = new Date();
          var hh = d.getHours();
          var m = d.getMinutes();
          var s = d.getSeconds();
          var dd = "AM";
          var h = hh;
          
          if (h >= 12) {
            h = hh-12;
            dd = "PM";
          }
          
          if (h == 0) {
            h = 12;
          }
          m = m<10?"0"+m:m;

          s = s<10?"0"+s:s;

          var timePosted = h + ":" + m + ":" + s + dd;




          var tweet = streams.home[index];
          var $tweet = $('<div class="actualTweets"></div>');
          $tweet.html(timePosted + '<a class="timelineLink" data-user="' + tweet.user + '">@' + tweet.user + '</a>: ' + tweet.message);
          $tweet.appendTo($('div#bodyOfTweets'));
          index -= 1;
        }

        
        function addTweetOnClick () {
          var d = new Date();
          var hh = d.getHours();
          var m = d.getMinutes();
          var s = d.getSeconds();
          var dd = "AM";
          var h = hh;
          
          if (h >= 12) {
            h = hh-12;
            dd = "PM";
          }
          
          if (h == 0) {
            h = 12;
          }
          m = m<10?"0"+m:m;

          s = s<10?"0"+s:s;

          var timePosted = h + ":" + m + ":" + s + dd;
          var index = streams.home.length-1;
          var tweet = streams.home[index];
          

          var $tweet = $('<div class="actualTweets"></div>')
          $tweet.html(timePosted + '<a class="timelineLink" data-user="' + tweet.user + '">@' + tweet.user + '</a>: ' + tweet.message);
          $tweet.prependTo($('div#bodyOfTweets'));
        };
        
        

        var writeTweet = function(message){
          var twert = {};
          twert.user = "me";
          twert.message = message;
          addTweet(twert);
        };


        function printTweet () {
          var d = new Date();
          var hh = d.getHours();
          var m = d.getMinutes();
          var s = d.getSeconds();
          var dd = "AM";
          var h = hh;
          
          if (h >= 12) {
            h = hh-12;
            dd = "PM";
          }
          
          if (h == 0) {
            h = 12;
          }
          m = m<10?"0"+m:m;

          s = s<10?"0"+s:s;
        

          var timePosted = h + ":" + m + ":" + s + dd;
          var ownTweet = $('#writeOwnTweet').val();
          var $tweet = $('<div class="actualTweets" ></div>');
          $tweet.html(timePosted + '<a class="timelineLink" data-user="me">@me</a>: ' + ownTweet);
          // streams.users[me] = [];
          // streams.users[me].push(ownTweet);
        
          if (ownTweet) {
            $tweet.prependTo($('div#bodyOfTweets'));
          }

          // writeTweet(ownTweet);


        }
      
        function eraseAfterClick() {
          $("#writeOwnTweet").val(null);
        };

        function submitUserInput() {
          printTweet();
          eraseAfterClick();
        }

        $("#newTweeter").click(addTweetOnClick);
        $("#submit-btn").click(submitUserInput);

        $("#writeOwnTweet").bind('keypress', function(e) {
          if(e.keyCode==13){
            submitUserInput();
          }
        });


        $(".timelineLink").on('click', function(){
          var user = $(this).data('user'); 
          $('#bodyOfTweets').empty();
          $("#buttonsAndInput").empty();
          for(var key in streams.users){
            if(key === user){
              $.each(streams.users[key], function(key, value){
                $('#bodyOfTweets').append('<div class="actualTweets">' + timePosted + '<a class="timelineLink" data-user="' + value.user + '">@' + value.user + '</a>: ' + value.message + '</div>');
              });
            }
          }
      });




});

    </script>
  </body>
</html>